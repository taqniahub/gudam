Option Explicit 'Forces you to declare all variables
'Prevents VBScript from allocating space for undeclared (undefined) variables

'Steps to working with variables:
'1. Declare the Variable (Dim statement)
'2. Assign a value  (=)
'3. Use the Variable

'Declaring Variables
Dim MonthlyPayment, ZipCode, LoanTerm, Rate, Trade_In, AmtOwed, DownPayment
Dim Expected_MaxPrice, Actual_MaxPrice
Dim i

'Assigning Values to Variables

MonthlyPayment = 250
ZipCode = 22030
LoanTerm = "36 months"
Rate = 1.25
Trade_In = 25000
AmtOwed = 5000
DownPayment = 2500
Expected_MaxPrice = "$45,300"
	
For i = 1 to 3

	Print "********* Starting Iteration Number: " & i & " ***********"
	
	'Step 0: Close IE
	SystemUtil.CloseProcessByName "iexplore.exe"
	
	'Step 1: Launch IE and navigate to URL
	SystemUtil.Run "iexplore.exe", "www.edmunds.com/calculators"
	
	wait 5
	
	'Verify that the 'Auto Calculators' header exists on the page
	'Logic: If the header exists then msgbox "Pass - auto calc header exists", otherwise, msgbox "Failed - auto calc header doesn't exist"
	If Browser("micclass:=Browser").Page("micclass:=Page").WebElement("innertext:=Auto Calculators ", "html tag:=H2").Exist Then
		Print "Pass - Auto Calculator header Exists"
	Else
		Print "Failed - Auto Calculator header doesn't exist"	
	End If
	
	
	'Step 2: Enter Monthly Payment
	Browser("micclass:=Browser").Page("micclass:=Page").WebEdit("html id:=calc_input3", "html tag:=INPUT", "class:=input-dollar").Set MonthlyPayment
	
	
	'Step 3: Click on Go
	Browser("micclass:=Browser").Page("micclass:=Page").WebElement("innertext:=Go", "html tag:=SPAN", "index:=2").Click
	
	
	'Verify that the Monthly Payment Value has been captured accurately on the 2nd page
	'Logic: If the Monthly Payment Webedit exists with 'MonthlyPayment' value inside, then msgbox "Pass - MonthlyPayment value is correct". Otherwise, msgbox "Failed - MonthlyPayment value is incorrect"
	If Browser("micclass:=Browser").Page("micclass:=Page").WebEdit("html id:=ac_monthly_payment", "html tag:=INPUT", "value:="&MonthlyPayment).Exist(5) Then
		Print "Pass - MonthlyPayment value is correct"
	Else
		Print "Failed - MonthlyPayment value is incorrect"
	End If
	
	'***"value:="&MonthlyPayment --> Will be read as follows: "value:=300"
	
	'Step 4: Enter ZipCode
	Browser("micclass:=Browser").Page("micclass:=Page").WebEdit("html id:=ac_zip_code", "html tag:=INPUT", "class:=calc-zipcode").Set ZipCode
	
	'Step 5: Click on Update ZipCode Button
	Browser("micclass:=Browser").Page("micclass:=Page").WebElement("innertext:=Update Zip Code", "html tag:=SPAN").Click 
	
	'Step 6: Select the Loan Term
	Browser("micclass:=Browser").Page("micclass:=Page").WebList("name:=ac_loan_term", "html tag:=SELECT").Select LoanTerm
	
	'Step 7: Enter Finance Rate
	Browser("micclass:=Browser").Page("micclass:=Page").WebEdit("html id:=ac_market_finance_rate", "html tag:=INPUT", "class:=input-percentage").Set Rate
	
	'Step 8: Enter Trade In
	Browser("micclass:=Browser").Page("micclass:=Page").WebEdit("html id:=ac_vehicle2_price", "html tag:=INPUT", "class:=input-dollar").Set Trade_In
	
	'Step 9: Enter Amount Owed
	Browser("micclass:=Browser").Page("micclass:=Page").WebEdit("html id:=ac_vehicle2_value_owed", "html tag:=INPUT", "class:=input-dollar").Set AmtOwed
	
	'Step 10: Enter Down Payment
	Browser("micclass:=Browser").Page("micclass:=Page").WebEdit("html id:=ac_cash_down_payment", "html tag:=INPUT", "class:=input-dollar").Set DownPayment
	
	'Step 11: Click on Calculate
	Browser("micclass:=Browser").Page("micclass:=Page").WebElement("innertext:=Calculate", "html tag:=SPAN").Click
	
	wait 5
	
	'GetROProperty --> Captures a specified property value from an object in the AUT that has been identified
	'--> Get RunTime Object Property Value
	
	'Step 12: Capture the Max Price
	Actual_MaxPrice = Browser("micclass:=Browser").Page("micclass:=Page").WebElement("class:=calc-results-total", "html id:=ac_max_tmv_result", "html tag:=SPAN").GetROProperty("innertext")
	
	'Step 13: Verify the Max Price
	If Actual_MaxPrice = Expected_MaxPrice Then
		msgbox "Test Passed"
	Else
		msgbox "Test Failed"
	End If


	'Print the Values Used
	Print "~~~~~~~ Variable Values Used ~~~~~~~~~"
	Print "The value of MonthlyPayment is: " & MonthlyPayment
	Print "The value of ZipCode is: " & ZipCode
	Print "The Value of Rate is: " & Rate
	Print "The Value of Trade_In is: " & Trade_In
	Print "The Value of AmtOwed is: " & AmtOwed
	Print "The Value of DownPayment is: " & DownPayment

	'Redefining Variables:
	MonthlyPayment = MonthlyPayment + 50
	ZipCode = ZipCode + 1
	Rate = Rate + 0.5
	Trade_In = Trade_In + 1000
	AmtOwed = AmtOwed + 1500
	DownPayment = DownPayment + 2500
	
Next